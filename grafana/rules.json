{"apiVersion":1,"groups":[{"orgId":1,"name":"l5","folder":"otus","interval":"1m","rules":[{"uid":"f1cf15d5-3862-4a8c-a27a-dae4aa280ffa","title":"Error rate","condition":"C","data":[{"refId":"A","relativeTimeRange":{"from":21600,"to":0},"datasourceUid":"prometheus","model":{"datasource":{"type":"prometheus","uid":"prometheus"},"disableTextWrap":false,"editorMode":"code","expr":"sum(rate(http_server_requests_seconds_count{application=\"purchase-service\", status=~\"5..\"}[1m]))","fullMetaSearch":false,"includeNullMetadata":true,"instant":false,"interval":"","intervalMs":30000,"legendFormat":"user-service","maxDataPoints":43200,"range":true,"refId":"A","useBackend":false}},{"refId":"B","relativeTimeRange":{"from":21600,"to":0},"datasourceUid":"__expr__","model":{"conditions":[{"evaluator":{"params":[],"type":"gt"},"operator":{"type":"and"},"query":{"params":["B"]},"reducer":{"params":[],"type":"last"},"type":"query"}],"datasource":{"type":"__expr__","uid":"__expr__"},"expression":"A","intervalMs":1000,"maxDataPoints":43200,"reducer":"last","refId":"B","type":"reduce"}},{"refId":"C","relativeTimeRange":{"from":21600,"to":0},"datasourceUid":"__expr__","model":{"conditions":[{"evaluator":{"params":[1],"type":"gt"},"operator":{"type":"and"},"query":{"params":["C"]},"reducer":{"params":[],"type":"last"},"type":"query"}],"datasource":{"type":"__expr__","uid":"__expr__"},"expression":"B","intervalMs":1000,"maxDataPoints":43200,"refId":"C","type":"threshold"}}],"dasboardUid":"fc5e6e93-d6a1-4136-8232-b00bc6bc36b3","panelId":3,"noDataState":"NoData","execErrState":"OK","for":"1m","annotations":{"__dashboardUid__":"fc5e6e93-d6a1-4136-8232-b00bc6bc36b3","__panelId__":"3"},"labels":{},"isPaused":false},{"uid":"cf37beef-3538-41d6-94b8-82a3ddf3f7ae","title":"Ingress error rate","condition":"C","data":[{"refId":"A","relativeTimeRange":{"from":900,"to":0},"datasourceUid":"prometheus","model":{"datasource":{"type":"prometheus","uid":"prometheus"},"disableTextWrap":false,"editorMode":"code","expr":"sum(rate(nginx_ingress_controller_connect_duration_seconds_count{ingress=\"purchase-service\", status=~\"5..\"}[1m]))","fullMetaSearch":false,"includeNullMetadata":true,"instant":false,"interval":"","intervalMs":30000,"legendFormat":"user-service","maxDataPoints":43200,"range":true,"refId":"A","useBackend":false}},{"refId":"B","relativeTimeRange":{"from":900,"to":0},"datasourceUid":"__expr__","model":{"conditions":[{"evaluator":{"params":[0,0],"type":"gt"},"operator":{"type":"and"},"query":{"params":[]},"reducer":{"params":[],"type":"avg"},"type":"query"}],"datasource":{"name":"Expression","type":"__expr__","uid":"__expr__"},"expression":"A","intervalMs":1000,"maxDataPoints":43200,"reducer":"last","refId":"B","type":"reduce"}},{"refId":"C","relativeTimeRange":{"from":900,"to":0},"datasourceUid":"__expr__","model":{"conditions":[{"evaluator":{"params":[1,0],"type":"gt"},"operator":{"type":"and"},"query":{"params":[]},"reducer":{"params":[],"type":"avg"},"type":"query"}],"datasource":{"name":"Expression","type":"__expr__","uid":"__expr__"},"expression":"B","intervalMs":1000,"maxDataPoints":43200,"refId":"C","type":"threshold"}}],"dasboardUid":"fc5e6e93-d6a1-4136-8232-b00bc6bc36b3","panelId":7,"noDataState":"NoData","execErrState":"Error","for":"1m","annotations":{"__dashboardUid__":"fc5e6e93-d6a1-4136-8232-b00bc6bc36b3","__panelId__":"7"},"labels":{},"isPaused":false},{"uid":"c3cd10bf-3b86-44df-b8ea-2d42f7c70f6b","title":"Latency","condition":"F","data":[{"refId":"C","relativeTimeRange":{"from":300,"to":0},"datasourceUid":"prometheus","model":{"datasource":{"type":"prometheus","uid":"prometheus"},"disableTextWrap":false,"editorMode":"builder","exemplar":false,"expr":"histogram_quantile(1, sum by(le) (rate(http_server_requests_seconds_bucket{status!~\"5..\", application=\"purchase-service\"}[1m])))","fullMetaSearch":false,"includeNullMetadata":true,"instant":false,"interval":"","intervalMs":30000,"legendFormat":"max","maxDataPoints":43200,"range":true,"refId":"C","useBackend":false}},{"refId":"B","relativeTimeRange":{"from":300,"to":0},"datasourceUid":"prometheus","model":{"datasource":{"type":"prometheus","uid":"prometheus"},"disableTextWrap":false,"editorMode":"code","expr":"histogram_quantile(0.99, sum by(le) (rate(http_server_requests_seconds_bucket{status!~\"5..\", application=\"purchase-service\"}[1m])))","fullMetaSearch":false,"includeNullMetadata":true,"instant":false,"interval":"","intervalMs":30000,"legendFormat":"99%","maxDataPoints":43200,"range":true,"refId":"B","useBackend":false}},{"refId":"A","relativeTimeRange":{"from":300,"to":0},"datasourceUid":"prometheus","model":{"datasource":{"type":"prometheus","uid":"prometheus"},"disableTextWrap":false,"editorMode":"code","exemplar":false,"expr":"histogram_quantile(0.95, sum by(le) (rate(http_server_requests_seconds_bucket{status!~\"5..\", application=\"purchase-service\"}[1m])))","format":"time_series","fullMetaSearch":false,"includeNullMetadata":true,"instant":false,"interval":"","intervalMs":30000,"legendFormat":"95%","maxDataPoints":43200,"range":true,"refId":"A","useBackend":false}},{"refId":"D","relativeTimeRange":{"from":300,"to":0},"datasourceUid":"prometheus","model":{"datasource":{"type":"prometheus","uid":"prometheus"},"disableTextWrap":false,"editorMode":"code","exemplar":false,"expr":"histogram_quantile(0.5, sum by(le) (rate(http_server_requests_seconds_bucket{status!~\"5..\", application=\"purchase-service\"}[1m])))","fullMetaSearch":false,"includeNullMetadata":true,"instant":true,"interval":"","intervalMs":30000,"legendFormat":"50%","maxDataPoints":43200,"range":false,"refId":"D","useBackend":false}},{"refId":"E","relativeTimeRange":{"from":300,"to":0},"datasourceUid":"__expr__","model":{"conditions":[{"evaluator":{"params":[0,0],"type":"gt"},"operator":{"type":"and"},"query":{"params":[]},"reducer":{"params":[],"type":"avg"},"type":"query"}],"datasource":{"name":"Expression","type":"__expr__","uid":"__expr__"},"expression":"A","intervalMs":1000,"maxDataPoints":43200,"reducer":"last","refId":"E","type":"reduce"}},{"refId":"F","relativeTimeRange":{"from":300,"to":0},"datasourceUid":"__expr__","model":{"conditions":[{"evaluator":{"params":[0.02,0],"type":"gt"},"operator":{"type":"and"},"query":{"params":[]},"reducer":{"params":[],"type":"avg"},"type":"query"}],"datasource":{"name":"Expression","type":"__expr__","uid":"__expr__"},"expression":"E","intervalMs":1000,"maxDataPoints":43200,"refId":"F","type":"threshold"}}],"dasboardUid":"fc5e6e93-d6a1-4136-8232-b00bc6bc36b3","panelId":1,"noDataState":"NoData","execErrState":"Error","for":"1m","annotations":{"__dashboardUid__":"fc5e6e93-d6a1-4136-8232-b00bc6bc36b3","__panelId__":"1"},"labels":{},"isPaused":false},{"uid":"e4a495d9-91de-4de3-90ba-48d896cd00c0","title":"Ingress latency","condition":"E","data":[{"refId":"C","relativeTimeRange":{"from":300,"to":0},"datasourceUid":"prometheus","model":{"datasource":{"type":"prometheus","uid":"prometheus"},"disableTextWrap":false,"editorMode":"builder","exemplar":false,"expr":"histogram_quantile(1, sum by(le) (rate(nginx_ingress_controller_header_duration_seconds_bucket{status!~\"5..\", ingress=\"purchase-service\"}[1m])))","fullMetaSearch":false,"includeNullMetadata":true,"instant":false,"interval":"","intervalMs":30000,"legendFormat":"max","maxDataPoints":43200,"range":true,"refId":"C","useBackend":false}},{"refId":"B","relativeTimeRange":{"from":300,"to":0},"datasourceUid":"prometheus","model":{"datasource":{"type":"prometheus","uid":"prometheus"},"disableTextWrap":false,"editorMode":"builder","expr":"histogram_quantile(0.99, sum by(le) (rate(nginx_ingress_controller_header_duration_seconds_bucket{status!~\"5..\", ingress=\"purchase-service\"}[1m])))","fullMetaSearch":false,"includeNullMetadata":true,"instant":false,"interval":"","intervalMs":30000,"legendFormat":"99%","maxDataPoints":43200,"range":true,"refId":"B","useBackend":false}},{"refId":"A","relativeTimeRange":{"from":300,"to":0},"datasourceUid":"prometheus","model":{"datasource":{"type":"prometheus","uid":"prometheus"},"disableTextWrap":false,"editorMode":"builder","expr":"histogram_quantile(0.95, sum by(le) (rate(nginx_ingress_controller_header_duration_seconds_bucket{status!~\"5..\", ingress=\"purchase-service\"}[1m])))","fullMetaSearch":false,"includeNullMetadata":true,"instant":false,"interval":"","intervalMs":30000,"legendFormat":"95%","maxDataPoints":43200,"range":true,"refId":"A","useBackend":false}},{"refId":"D","relativeTimeRange":{"from":300,"to":0},"datasourceUid":"prometheus","model":{"datasource":{"type":"prometheus","uid":"prometheus"},"disableTextWrap":false,"editorMode":"builder","expr":"histogram_quantile(0.5, sum by(le) (rate(nginx_ingress_controller_header_duration_seconds_bucket{status!~\"5..\", ingress=\"purchase-service\"}[1m])))","fullMetaSearch":false,"includeNullMetadata":true,"instant":false,"interval":"","intervalMs":30000,"legendFormat":"50%","maxDataPoints":43200,"range":true,"refId":"D","useBackend":false}},{"refId":"F","relativeTimeRange":{"from":300,"to":0},"datasourceUid":"__expr__","model":{"conditions":[{"evaluator":{"params":[0,0],"type":"gt"},"operator":{"type":"and"},"query":{"params":[]},"reducer":{"params":[],"type":"avg"},"type":"query"}],"datasource":{"name":"Expression","type":"__expr__","uid":"__expr__"},"expression":"A","intervalMs":1000,"maxDataPoints":43200,"reducer":"last","refId":"F","type":"reduce"}},{"refId":"E","relativeTimeRange":{"from":300,"to":0},"datasourceUid":"__expr__","model":{"conditions":[{"evaluator":{"params":[0.02,0],"type":"gt"},"operator":{"type":"and"},"query":{"params":[]},"reducer":{"params":[],"type":"avg"},"type":"query"}],"datasource":{"name":"Expression","type":"__expr__","uid":"__expr__"},"expression":"F","intervalMs":1000,"maxDataPoints":43200,"refId":"E","type":"threshold"}}],"dasboardUid":"fc5e6e93-d6a1-4136-8232-b00bc6bc36b3","panelId":8,"noDataState":"NoData","execErrState":"Error","for":"1m","annotations":{"__dashboardUid__":"fc5e6e93-d6a1-4136-8232-b00bc6bc36b3","__panelId__":"8"},"labels":{},"isPaused":false}]}]}